"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[950],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),u=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=u(e.components);return r.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=u(n),m=o,h=d["".concat(l,".").concat(m)]||d[m]||c[m]||a;return n?r.createElement(h,i(i({ref:t},p),{},{components:n})):r.createElement(h,i({ref:t},p))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var u=2;u<a;u++)i[u]=n[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},3987:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return u},toc:function(){return p},default:function(){return d}});var r=n(7462),o=n(3366),a=(n(7294),n(3905)),i=["components"],s={title:"Horizontall",sidebar_position:3},l=void 0,u={unversionedId:"HTB - Horizontall/notes",id:"HTB - Horizontall/notes",title:"Horizontall",description:"Horizontall",source:"@site/docs/HTB - Horizontall/notes.md",sourceDirName:"HTB - Horizontall",slug:"/HTB - Horizontall/notes",permalink:"/docs/HTB - Horizontall/notes",tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"Horizontall",sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Welcome!",permalink:"/docs/welcome"},next:{title:"Baby Apt - Forensics",permalink:"/docs/HTB - Cyber Santa/baby_apt"}},p=[{value:"Horizontall",id:"horizontall",children:[],level:2},{value:"Enumeration:",id:"enumeration",children:[{value:"NMAP",id:"nmap",children:[],level:3},{value:"gobuster",id:"gobuster",children:[],level:3},{value:"wfuzz",id:"wfuzz",children:[],level:3}],level:2},{value:"Information:",id:"information",children:[{value:"Host Info",id:"host-info",children:[],level:3}],level:2},{value:"Notes:",id:"notes",children:[],level:2}],c={toc:p};function d(e){var t=e.components,s=(0,o.Z)(e,i);return(0,a.kt)("wrapper",(0,r.Z)({},c,s,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"horizontall"},"Horizontall"),(0,a.kt)("h2",{id:"enumeration"},"Enumeration:"),(0,a.kt)("h3",{id:"nmap"},"NMAP"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"nmap -sC -sV -oA nmap/nmap.scan $IP\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"# Nmap 7.92 scan initiated Wed Nov 24 12:38:22 2021 as: nmap -sC -sV -v -oA nmap/nmap.init 10.10.11.105\nNmap scan report for horizontall.htb (10.10.11.105)\nHost is up (0.55s latency).\nNot shown: 998 closed tcp ports (conn-refused)\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 ee:77:41:43:d4:82:bd:3e:6e:6e:50:cd:ff:6b:0d:d5 (RSA)\n|   256 3a:d5:89:d5:da:95:59:d9:df:01:68:37:ca:d5:10:b0 (ECDSA)\n|_  256 4a:00:04:b4:9d:29:e7:af:37:16:1b:4f:80:2d:98:94 (ED25519)\n80/tcp open  http    nginx 1.14.0 (Ubuntu)\n|_http-title: horizontall\n| http-methods: \n|_  Supported Methods: GET HEAD\n|_http-server-header: nginx/1.14.0 (Ubuntu)\n|_http-favicon: Unknown favicon MD5: 1BA2AE710D927F13D483FD5D1E548C9B\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nRead data files from: /usr/bin/../share/nmap\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\n# Nmap done at Wed Nov 24 12:47:43 2021 -- 1 IP address (1 host up) scanned in 561.34 seconds\n")),(0,a.kt)("h3",{id:"gobuster"},"gobuster"),(0,a.kt)("p",null,"Nothing useful on horizontall.htb\nfuzzing api-prod.horizontall.htb:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"gobuster dir -u http://api-prod.horizontall.htb -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x html,txt,php\n")),(0,a.kt)("p",null,"output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"===============================================================\nGobuster v3.1.0\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://api-prod.horizontall.htb\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.1.0\n[+] Extensions:              html,txt,php\n[+] Timeout:                 10s\n===============================================================\n2021/11/24 13:35:59 Starting gobuster in directory enumeration mode\n===============================================================\n/index.html           (Status: 200) [Size: 413]\n/reviews              (Status: 200) [Size: 507]\n/users                (Status: 403) [Size: 60] \n/admin                (Status: 200) [Size: 854]\n/Reviews              (Status: 200) [Size: 507]\n/robots.txt           (Status: 200) [Size: 121]\n/Users                (Status: 403) [Size: 60] \n/Admin                (Status: 200) [Size: 854]\nProgress: 74236 / 882244 (8.41%)              ^C\n[!] Keyboard interrupt detected, terminating.\n                                               \n===============================================================\n2021/11/24 13:47:47 Finished\n===============================================================\n\n")),(0,a.kt)("h3",{id:"wfuzz"},"wfuzz"),(0,a.kt)("p",null,"Enumerating subdomains:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'wfuzz -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -u http://horizontall.htb --hc 301 -v -c -H "HOST:FUZZ.horizontall.htb"\n')),(0,a.kt)("p",null,"Output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://horizontall.htb/\nTotal requests: 114441\n\n====================================================================================================================================================\nID           C.Time       Response   Lines      Word     Chars       Server                           Redirect                         Payload                                      \n====================================================================================================================================================\n\n000000001:   0.462s       200        1 L        43 W     901 Ch      nginx/1.14.0 (Ubuntu)                                             "www - www"                                  \n000047093:   0.085s       200        19 L       33 W     413 Ch      nginx/1.14.0 (Ubuntu)                                             "api-prod - api-prod"                        \n^C /usr/lib/python3/dist-packages/wfuzz/wfuzz.py:80: UserWarning:Finishing pending requests...\n\nTotal time: 0\nProcessed Requests: 47919\nFiltered Requests: 47917\nRequests/sec.: 0\n\n')),(0,a.kt)("h2",{id:"information"},"Information:"),(0,a.kt)("h3",{id:"host-info"},"Host Info"),(0,a.kt)("p",null,"OS: Ubuntu (Unknown Version)\nWebserver: Nginx 1.14.0",(0,a.kt)("br",{parentName:"p"}),"\n","Ports open: 22, 80",(0,a.kt)("br",{parentName:"p"}),"\n","domains: horizontall.htb, api-prod.horizontall.htb  "),(0,a.kt)("h2",{id:"notes"},"Notes:"),(0,a.kt)("p",null,"Port 22 and 80 open."),(0,a.kt)("p",null,"Inspecting webserver on 80. None of the buttons work. Need to do\nfurther enumeration."),(0,a.kt)("p",null,"Error on webserver says its nginx 1.14.0 on ubuntu."),(0,a.kt)("p",null,"Hosting nginx, makes me think its not PHP."),(0,a.kt)("p",null,"Required adding hostname to /etc/hosts, maybe we have some subdomains?"),(0,a.kt)("p",null,"Found api-prod subdomain with wfuzz, added to /etc/hosts."),(0,a.kt)("p",null,"Result from going to api-prod.horizontall.htb:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image",src:n(910).Z})),(0,a.kt)("p",null,"Time to do some enumeration on that subdomain."),(0,a.kt)("p",null,"Found some directories, one is /admin"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image",src:n(7620).Z}),"  "),(0,a.kt)("p",null,"Research exploits for strapi\nFind some on exploit-db but don't know the version number of whats running on the host.\nInspecting one of the exploits gives me this url to check the version:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image",src:n(6009).Z})),(0,a.kt)("p",null,"Our version is vulnerable to the exploit on ",(0,a.kt)("a",{parentName:"p",href:"https://www.exploit-db.com/exploits/50239"},"exploit-db"),"\nUse exploit to get credentials for admin user:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image",src:n(9594).Z})),(0,a.kt)("p",null,"Now that I have a JWT token I can exploit the other CVE using this ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/z9fr/CVE-2019-19609/blob/main/exploit.py"},"script")," to get a reverse shell on the box."),(0,a.kt)("p",null,"Running second stage exploit:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image",src:n(9911).Z})),(0,a.kt)("p",null,"Getting a shell:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image",src:n(7377).Z})),(0,a.kt)("p",null,"Need to get root\nGetting the port fowarding was tricky, had to lookup guide.\nInspect machine to see what services are running, seeing laravel running locally so use chisel to port foward to attacker machine:\nOn client:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image",src:n(5164).Z})),(0,a.kt)("p",null,"On attacker:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image",src:n(538).Z})),(0,a.kt)("p",null,"Now I can access the laravel service on my attacker machine:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image",src:n(8834).Z})),(0,a.kt)("p",null,"Do some googling and find an exploit for this laravel version ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/nth347/CVE-2021-3129_exploit"},"here"),"\nRun the exploit and I can cat the root flag:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image",src:n(9989).Z})))}d.isMDXComponent=!0},7620:function(e,t,n){t.Z=n.p+"assets/images/admin-816f74f51f4d5638d30f5ae705b20bf1.png"},9594:function(e,t,n){t.Z=n.p+"assets/images/admin_creds-55e3e8a66b5bba69e5e30d156ff94244.png"},5164:function(e,t,n){t.Z=n.p+"assets/images/chisel_client-1b996225c9cd0ba19b39064615688a7e.png"},538:function(e,t,n){t.Z=n.p+"assets/images/chisel_server-1b797c81568077d85f5dbcae647682ff.png"},7377:function(e,t,n){t.Z=n.p+"assets/images/init_shell-23a48886f0dbb1040640be11a7d90ef1.png"},8834:function(e,t,n){t.Z=n.p+"assets/images/laravel-5248348424f80bd661fb34778dfaee4b.png"},9989:function(e,t,n){t.Z=n.p+"assets/images/root_flag-bb3d159ac98dd90075e749a7c0bf65f1.png"},9911:function(e,t,n){t.Z=n.p+"assets/images/second_stage-8b84c4afb7f88dc3b8b376fb0f81e176.png"},6009:function(e,t,n){t.Z=n.p+"assets/images/version-f8721b9b4b6cb738139e79fe279a430c.png"},910:function(e,t,n){t.Z=n.p+"assets/images/welcome-25bb476d573c0ff8ac5a27d8e1ddad9d.png"}}]);